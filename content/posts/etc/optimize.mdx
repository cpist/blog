---
title: "Optimize Galaxy book"
date: "2025-12-31"
summary: "Optimize Galaxy book 5 Pro"
tags: ["etc", "Tip"]
draft: false
---

1. WorkloadsSessionHost.exe (Windows AI 기능 관련)
이 프로세스는 윈도우 11의 최신 AI 기능(Recall, Click to Do 등)을 관리하는 Windows Workload Manager의 일부임. 
특히 갤럭시북5 프로처럼 NPU가 탑재된 Core Ultra 모델에서 활발하게 작동하며, 메모리 누수(Memory Leak) 이슈가 보고됨.
이유: 백그라운드에서 화면을 분석하거나 AI 기반 작업을 준비하기 위해 지속적으로 리소스를 상주시키기 때문임.

최적화 방법:
- Recall 및 Click to Do 비활성화: 설정 > 개인 정보 및 보안 > Recall & snapshots (또는 회상) 메뉴에서 기능을 끔.
- 서비스 중지: Win + R > services.msc 입력 후 **Windows AI Fabric Service (WSAIFabricSvc)**를 찾아 중지 및 사용 안 함으로 설정함.
    - 결과: 이 작업만으로도 수백 MB에서 많게는 1~2GB의 여유 메모리를 확보할 수 있습니다.

2. Desktop Window Manager (dwm.exe)
윈도우의 모든 창 관리, 투명도 효과, 애니메이션을 담당하는 프로세스임.
이유: 고해상도 OLED 디스플레이와 높은 주사율(120Hz)을 사용하는 갤럭시북 특성상 그래픽 자원을 많이 소모함. 
또한, 인텔 그래픽 드라이버의 버그로 인해 메모리가 계속 쌓이는 현상이 발생할 수 있음.

최적화 방법:
- 그래픽 드라이버 업데이트: 삼성 업데이트 대신 인텔 공식 홈페이지에서 최신 Arc Graphics 드라이버를 직접 내려받아 설치. (가장 효과적인 해결책)
- 투명도 효과 끄기: 설정 > 개인 설정 > 색 > 투명도 효과를 '끔'으로 설정합니다.
- 시각 효과 제한: 제어판 > 시스템 > 고급 시스템 설정 > 성능(설정)에서 **'최적 성능으로 조정'**을 선택하면 dwm.exe의 부담이 크게 줄어듭니다.

3. Command
```
cmake -G Ninja -S llvm -B build \
  -DLLVM_ENABLE_PROJECTS="mlir;clang" \
  -DLLVM_TARGETS_TO_BUILD="X86" \
  -DCMAKE_BUILD_TYPE=Release \
  -DLLVM_ENABLE_ASSERTIONS=ON \
  -DCMAKE_C_COMPILER=clang \
  -DCMAKE_CXX_COMPILER=clang++ \
  -DLLVM_USE_LINKER=lld \
  -DLLVM_PARALLEL_LINK_JOBS=1 \
  -DBUILD_SHARED_LIBS=ON \
  -DCMAKE_EXPORT_COMPILE_COMMANDS=ON \
  -DLLVM_CCACHE_BUILD=ON

// 이후 아래 커맨드 진행
ninja -C build -j4
```

완료 되면 아래와 같이 잘 빌드 되었는지 mlir-opt 실행을 확인해 보자.
```
./build/bin/mlir-opt --version
```

=================================

빈번하게 하는 활동이니 기억해두자.
