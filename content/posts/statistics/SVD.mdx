---
title: "Compiler에 필요한 선형대수 - SVD / QR 분해"
date: "2026-01-10"
summary: "SVD and QR Decomposition"
tags: ["etc", "Linear Algebra", "statistics"]
draft: false
---
SVD 와 QR 분해는 AI 컴파일러에서 가중치 압축 및 연산 최적화 분석에 활용됨.

1) 우선 QR 분해 (QR Decomposition)
QR 분해는 행렬 $A$를 **직교 행렬(Orthogonal matrix) $Q$**와 **상삼각 행렬(Upper triangular matrix) $R$**의 곱으로 나타내는 방법 이다.

공식은 $$A = QR$$
- $Q$ (Orthogonal Matrix): 각 열벡터들이 서로 수직이고 크기가 1임. ($Q^TQ = I$)
    - 수직의 의미는 두 벡터의 내적(Inner product) 이 0이라는 것이고.
- $R$ (Upper Triangular Matrix): 대각선 아래의 성분이 모두 0인 행렬
- 용도: 선형 연립방정식 해결, 최소자승법(Least Squares), 고윳값 계산(QR Algorithm)

* 의미
- Gram-Schmidt 과정을 수식화한 것
- 행렬의 직교화를 통해 수치적 불안정성을 줄여주기 때문에, 정밀한 계산이 필요한 시스템에서 $Ax = b$를 풀 때 자주 사용

2) SVD (Singular Value Decomposition)
SVD는 임의의 $m \times n$ 행렬 $A$를 세 행렬의 곱으로 분해하는, 선형대수학에서 가장 강력한 도구 중 하나

공식은 $$A = U\Sigma V^T$$
- $U$ (Left Singular Matrix): $AA^T$의 고유벡터들로 구성된 $m \times m$ 직교 행렬
- $\Sigma$ (Singular Value Matrix): $A^TA$의 고윳값들의 제곱근($\sigma_i$)을 대각 성분으로 가지는 $m \times n$ 직사각 대각 행렬. (내림차순 정렬)
- $V$ (Right Singular Matrix): $A^TA$의 고유벡터들로 구성된 $n \times n$ 직교 행렬

* 의미
- SVD는 행렬을 '회전($V^T$) → 스케일 변화($\Sigma$) → 회전($U$)'의 과정으로 분해
- 정보량이 적은 작은 특잇값들을 제거함으로써 데이터 압축(PCA)이나 노이즈 제거에 탁월한 성능을 보임

3) 생각해 볼 포인트
- SVD에서 왜 $A^TA$를 계산하는가?
    - SVD의 핵심은 '행렬 $A$가 공간을 어떻게 변형시키는가'를 찾는 것임. 
    - $A^TA$는 대칭 행렬이 되어 항상 직교하는 고유벡터($V$)를 가짐.
    -  이 고유벡터들은 $A$에 의해 변형되기 전의 '주축' 역할을 하며, 고윳값은 그 축으로 얼마만큼 늘어나는지($\sigma^2$)를 알려줌.
- QR 분해가 SVD보다 선형 연립방정식 풀이에 선호되는 이유는?
    - SVD는 고윳값을 찾기 위해 반복적(Iterative)인 수치 해석 기법이 필요하여 계산 비용이 매우 큼.
    - 반면 QR 분해는 Gram-Schmidt나 Householder 변환을 통해 유한한 단계 내에 계산이 끝나므로 훨씬 빠름.