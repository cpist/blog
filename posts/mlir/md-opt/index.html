<!DOCTYPE html><!--5hTOFQgAyP0gWgEA_2kpB--><html lang="ko"><head><meta charSet="utf-8"/><link rel="preconnect" href="/" crossorigin=""/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/blog/_next/static/chunks/743a8f8bdb738f7f.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/blog/_next/static/chunks/2139e000f4b5d584.js"/><script src="/blog/_next/static/chunks/8a8ef77865bda9e6.js" async=""></script><script src="/blog/_next/static/chunks/0ff423a9fcc0186e.js" async=""></script><script src="/blog/_next/static/chunks/88a8688d62cd2814.js" async=""></script><script src="/blog/_next/static/chunks/turbopack-566b9f8f22ac84c4.js" async=""></script><script src="/blog/_next/static/chunks/796e69ae18b2784c.js" async=""></script><script src="/blog/_next/static/chunks/ff1a16fafef87110.js" async=""></script><script src="/blog/_next/static/chunks/247eb132b7f7b574.js" async=""></script><script src="/blog/_next/static/chunks/631eeae4923b8465.js" async=""></script><link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" as="style" crossorigin="anonymous" integrity="sha384-n8MVd4RsNIU0KOVEMVIqhKyMVPsoloXttrTHYUjDkaWaXIhKbMCh2GbqNl2CAPFu"/><title>MLIR Tutorial mlir-opt 에 대하여 - CPIST&#x27;s blog</title><meta name="description" content="Using mlir-opt"/><link rel="icon" href="/blog/favicon.ico?favicon.0b3bf435.ico" sizes="256x256" type="image/x-icon"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" integrity="sha384-n8MVd4RsNIU0KOVEMVIqhKyMVPsoloXttrTHYUjDkaWaXIhKbMCh2GbqNl2CAPFu" crossorigin="anonymous"/><script src="/blog/_next/static/chunks/a6dad97d9634a72d.js" noModule=""></script></head><body><div hidden=""><!--$--><!--/$--></div><main><header style="display:flex;justify-content:space-between;align-items:baseline;gap:12px"><h1 style="margin:8px 0"><a style="text-decoration:none" href="/blog/">CPIST&#x27;s blog</a></h1><nav style="display:flex;gap:12px"><a href="/blog/posts/">Posts</a></nav></header><hr style="border:0;border-top:1px solid #eee;margin:12px 0 24px"/><article style="max-width:800px;margin:0 auto;padding:20px"><div style="color:#666;margin-bottom:6px"><a href="/mlir" style="text-decoration:none">/<!-- -->mlir</a></div><h2 style="margin-top:0">MLIR Tutorial mlir-opt 에 대하여</h2><div style="color:#666;margin-bottom:18px">2025-12-07</div><p style="color:#333;font-style:italic">Using mlir-opt</p><hr style="border:0;border-top:1px solid #eee;margin:18px 0"/><div class="prose" style="line-height:1.6"><ol>
<li>mlir-opt란?</li>
</ol>
<ul>
<li>MLIR IR을 로드 <code>-&gt;</code> 패스 실행 <code>-&gt;</code> 다시 IR 로 출력하는 CLI 도구</li>
<li>주 용도:<!-- -->
<ul>
<li>패스 테스트</li>
<li>IR 변환 디버깅</li>
<li>Lowering 테스트</li>
</ul>
</li>
<li>Input / Output :<!-- -->
<ul>
<li>기본 Input : textual MLIR or bytecode</li>
<li>기본 Output : textual MLIR</li>
</ul>
</li>
<li>검증기 (verifier) 가 항상 실행 됨 <code>-&gt;</code> IR 유효성 검사 가능</li>
<li>빌드 후 위치 : build/bin/mlir-opt</li>
</ul>
<pre><code>mlir-opt &lt; input.mlir &gt; output.mlir
</code></pre>
<ul>
<li>IR이 잘 파싱되는지 확인하는 가장 간단한 방법</li>
</ul>
<ol start="2">
<li>기본 사용법 핵심
도움말</li>
</ol>
<pre><code>mlir-opt --help
</code></pre>
<ul>
<li>옵션 약 1000개 이상</li>
<li>각 패스마다 플래그가 있지만 권장 방식은 --pass-pipeline</li>
</ul>
<ol start="3">
<li>패스 실행 (--pass-pipeline)
기본 구조는</li>
</ol>
<pre><code>&lt;anchor-op&gt;(pass1,pass2,...)
</code></pre>
<ul>
<li>anchor-op : 패스가 적용되는 IR 노드 타입<!-- -->
<ul>
<li>예: builtin.module, func.func</li>
</ul>
</li>
<li>패스는 anchor 가 맞지 않으면 실행되지 않음</li>
</ul>
<p>ex) math <code>-&gt;</code> llvm 변환</p>
<pre><code>mlir-opt \
  --pass-pipeline=&quot;builtin.module(convert-math-to-llvm)&quot; \
  input.mlir
</code></pre>
<ul>
<li>결과는 MLIR의 llvm dialect</li>
<li>실제 LLVM IR 생성은 mlir-translate 가 필요함.</li>
</ul>
<ol start="4">
<li>옵션을 갖는 패스 실행
패스 옵션 문법</li>
</ol>
<pre><code>pass-name{option1=value1 option2=value2}
</code></pre>
<ul>
<li>공백으로 구분</li>
<li> 안에서 key=vaule 형태</li>
</ul>
<p>예시: affine loop fusion</p>
<pre><code>mlir-opt \
  --pass-pipeline=&quot;builtin.module(affine-loop-fusion{fusion-compute-tolerance=0})&quot; \
  loop_fusion.mlir
</code></pre>
<p>이 옵션의 의미는 fusion-compute-tolerance : 루프 퓨전 시 허용되는 추가 연산 비율을 의미한다. (추가 연산량을 얼마나 허용할지)
따라서 0이라는 것은 퓨전 비활성화를 의미한다.
참고로 비율(fraction으로) 주는 거라 0.1, 0.25 같이 줌. (각각 10%, 25% 증가 까지 허용)</p>
<pre><code>(퓨전 후 추가 연산량) / (기존 연산량)
</code></pre>
<ol start="5">
<li>여러 패스를 조합한 파이프라인
단순 체이닝</li>
</ol>
<pre><code>--pass-pipeline=&quot;builtin.module(pass1,pass2,pass3)&quot;
</code></pre>
<ul>
<li>순서대로 실행된다.</li>
</ul>
<ol start="6">
<li>중첩된 패스 앵커링
이 개념이 진짜 중요함.
필요한 이유는</li>
</ol>
<ul>
<li>패스는 특정 IR 레벨에서만 동작하고</li>
<li>올바른 nesting을 안 쓰면 패스가 아예 실행되지 않기 때문
예시 구조는 아래와 같음</li>
</ul>
<pre><code>module {
  module {
    func.func ...
  }
  gpu.module {
    gpu.func ...
  }
}
</code></pre>
<p>func.func 에만 CSE + canonicalize 적용</p>
<pre><code>mlir-opt --pass-pipeline=&#x27;
  builtin.module(
    builtin.module(
      func.func(cse,canonicalize),
      convert-to-llvm
    )
  )&#x27;
</code></pre>
<p>결과</p>
<ul>
<li>func.func 만 최적화 됨</li>
<li>gpu.module은 그대로 유지가 됨</li>
</ul>
<p>이러한 중첩 앵커링은 성능적으로 장점이 있음.</p>
<ul>
<li>패스가 IR 서브셋 단위로 병렬 실행이 가능함.</li>
<li>캐시 지역성 개선</li>
</ul>
<pre><code>builtin.module(func.func(...))

가

builtin.module(...)
보다 효율적임.
</code></pre>
<ol start="7">
<li>자주 쓰는 CLI 플래그들
디버깅 에서는</li>
</ol>
<ul>
<li>--debug</li>
<li>--debug-only=&quot;tag&quot;<!-- -->
<ul>
<li>&quot;greedy-rewriter&quot; 나 &quot;dialect-conversion&quot;</li>
</ul>
</li>
</ul>
<p>IR 출력</p>
<ul>
<li>--mlir-print-ir-after-all</li>
<li>--mlir-print-ir-after-change</li>
<li>--mlir-print-ir-after-failure</li>
<li><code>--mlir-print-ir-tree-dir=&lt;dir&gt;</code> (IR을 파일 트리로 저장함. 대규모 IR 디버깅 하려면 사실상 필수)</li>
</ul>
<p>통계 / 성능 관련해서는</p>
<ul>
<li>--mlir-pass-statistics</li>
<li>--mlir-timing</li>
</ul>
<p>기타</p>
<ul>
<li>--emit-bytecode : MLIR bytecode를 출력함.\</li>
</ul>
<p>=====================================================================</p>
<p>요약해 보자면</p>
<ul>
<li>mlir-opt는 MLIR 패스 실행의 표준 테스트 도구</li>
<li>패스 실행은 --pass-pipeline 사용이 정석임</li>
<li>패스 앵커링 (op-level) 개념을 이해해야 제대로 동작함</li>
<li>패스 옵션은 <code>{key=value}</code> 문법</li>
<li>중첩 파이프라인은 정확성 + 성능 모두에 중요함</li>
<li>디버깅시 --debug-only, --mlir-print-ir-*는 필수 도구임.</li>
</ul></div><hr style="border:0;border-top:1px solid #eee;margin:36px 0"/><div></div></article><!--$--><!--/$--><footer style="margin-top:48px;padding-top:16px;border-top:1px solid #eee;color:#666">© <!-- -->2026<!-- --> CPIST&#x27;s blog</footer></main><script src="/blog/_next/static/chunks/2139e000f4b5d584.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[22016,[\"/blog/_next/static/chunks/796e69ae18b2784c.js\"],\"\"]\n3:I[39756,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n4:I[37457,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"default\"]\n6:I[97367,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"OutletBoundary\"]\n7:\"$Sreact.suspense\"\n9:I[97367,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"ViewportBoundary\"]\nb:I[97367,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"MetadataBoundary\"]\nd:I[68027,[],\"default\"]\n:HL[\"/blog/_next/static/chunks/743a8f8bdb738f7f.css\",\"style\"]\n:HC[\"/\",\"\"]\n:HL[\"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css\",\"style\",{\"crossOrigin\":\"anonymous\",\"integrity\":\"sha384-n8MVd4RsNIU0KOVEMVIqhKyMVPsoloXttrTHYUjDkaWaXIhKbMCh2GbqNl2CAPFu\"}]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"5hTOFQgAyP0gWgEA_2kpB\",\"c\":[\"\",\"posts\",\"mlir\",\"md-opt\",\"\"],\"q\":\"\",\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"mlir/md-opt\",\"c\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/blog/_next/static/chunks/743a8f8bdb738f7f.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"script\",\"script-0\",{\"src\":\"/blog/_next/static/chunks/796e69ae18b2784c.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"ko\",\"children\":[[\"$\",\"head\",null,{\"children\":[\"$\",\"link\",null,{\"rel\":\"stylesheet\",\"href\":\"https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css\",\"integrity\":\"sha384-n8MVd4RsNIU0KOVEMVIqhKyMVPsoloXttrTHYUjDkaWaXIhKbMCh2GbqNl2CAPFu\",\"crossOrigin\":\"anonymous\"}]}],[\"$\",\"body\",null,{\"children\":[\"$\",\"main\",null,{\"children\":[[\"$\",\"header\",null,{\"style\":{\"display\":\"flex\",\"justifyContent\":\"space-between\",\"alignItems\":\"baseline\",\"gap\":12},\"children\":[[\"$\",\"h1\",null,{\"style\":{\"margin\":\"8px 0\"},\"children\":[\"$\",\"$L2\",null,{\"href\":\"/\",\"style\":{\"textDecoration\":\"none\"},\"children\":\"CPIST's blog\"}]}],[\"$\",\"nav\",null,{\"style\":{\"display\":\"flex\",\"gap\":12},\"children\":[\"$\",\"$L2\",null,{\"href\":\"/posts\",\"children\":\"Posts\"}]}]]}],[\"$\",\"hr\",null,{\"style\":{\"border\":0,\"borderTop\":\"1px solid #eee\",\"margin\":\"12px 0 24px\"}}],[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}],[\"$\",\"footer\",null,{\"style\":{\"marginTop\":48,\"paddingTop\":16,\"borderTop\":\"1px solid #eee\",\"color\":\"#666\"},\"children\":[\"© \",2026,\" CPIST's blog\"]}]]}]}]]}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"script\",\"script-0\",{\"src\":\"/blog/_next/static/chunks/631eeae4923b8465.js\",\"async\":true,\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.MetadataOutlet\",\"children\":\"$@8\"}]}]]}],{},null,false,false]},null,false,false]},null,false,false]},null,false,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$L9\",null,{\"children\":\"$@a\"}],[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"$7\",null,{\"name\":\"Next.Metadata\",\"children\":\"$@c\"}]}]}],null]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",[]],\"S\":true}\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"style\":{\"maxWidth\":\"800px\",\"margin\":\"0 auto\",\"padding\":\"20px\"},\"children\":[[\"$\",\"div\",null,{\"style\":{\"color\":\"#666\",\"marginBottom\":6},\"children\":[\"$\",\"a\",null,{\"href\":\"/mlir\",\"style\":{\"textDecoration\":\"none\"},\"children\":[\"/\",\"mlir\"]}]}],[\"$\",\"h2\",null,{\"style\":{\"marginTop\":0},\"children\":\"MLIR Tutorial mlir-opt 에 대하여\"}],[\"$\",\"div\",null,{\"style\":{\"color\":\"#666\",\"marginBottom\":18},\"children\":\"2025-12-07\"}],[\"$\",\"p\",null,{\"style\":{\"color\":\"#333\",\"fontStyle\":\"italic\"},\"children\":\"Using mlir-opt\"}],[\"$\",\"hr\",null,{\"style\":{\"border\":0,\"borderTop\":\"1px solid #eee\",\"margin\":\"18px 0\"}}],[\"$\",\"div\",null,{\"className\":\"prose\",\"style\":{\"lineHeight\":1.6},\"children\":[[\"$\",\"ol\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"mlir-opt란?\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"MLIR IR을 로드 \",[\"$\",\"code\",null,{\"children\":\"-\u003e\"}],\" 패스 실행 \",[\"$\",\"code\",null,{\"children\":\"-\u003e\"}],\" 다시 IR 로 출력하는 CLI 도구\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"주 용도:\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스 테스트\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"IR 변환 디버깅\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Lowering 테스트\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Input / Output :\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"기본 Input : textual MLIR or bytecode\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"기본 Output : textual MLIR\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"검증기 (verifier) 가 항상 실행 됨 \",[\"$\",\"code\",null,{\"children\":\"-\u003e\"}],\" IR 유효성 검사 가능\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"빌드 후 위치 : build/bin/mlir-opt\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"mlir-opt \u003c input.mlir \u003e output.mlir\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"IR이 잘 파싱되는지 확인하는 가장 간단한 방법\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"2\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"기본 사용법 핵심\\n도움말\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"mlir-opt --help\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"옵션 약 1000개 이상\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"각 패스마다 플래그가 있지만 권장 방식은 --pass-pipeline\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"3\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스 실행 (--pass-pipeline)\\n기본 구조는\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"\u003canchor-op\u003e(pass1,pass2,...)\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"anchor-op : 패스가 적용되는 IR 노드 타입\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"예: builtin.module, func.func\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스는 anchor 가 맞지 않으면 실행되지 않음\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"ex) math \",[\"$\",\"code\",null,{\"children\":\"-\u003e\"}],\" llvm 변환\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"mlir-opt \\\\\\n  --pass-pipeline=\\\"builtin.module(convert-math-to-llvm)\\\" \\\\\\n  input.mlir\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"결과는 MLIR의 llvm dialect\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"실제 LLVM IR 생성은 mlir-translate 가 필요함.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"4\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"옵션을 갖는 패스 실행\\n패스 옵션 문법\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"pass-name{option1=value1 option2=value2}\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"공백으로 구분\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\" 안에서 key=vaule 형태\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"예시: affine loop fusion\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"mlir-opt \\\\\\n  --pass-pipeline=\\\"builtin.module(affine-loop-fusion{fusion-compute-tolerance=0})\\\" \\\\\\n  loop_fusion.mlir\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"이 옵션의 의미는 fusion-compute-tolerance : 루프 퓨전 시 허용되는 추가 연산 비율을 의미한다. (추가 연산량을 얼마나 허용할지)\\n따라서 0이라는 것은 퓨전 비활성화를 의미한다.\\n참고로 비율(fraction으로) 주는 거라 0.1, 0.25 같이 줌. (각각 10%, 25% 증가 까지 허용)\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"(퓨전 후 추가 연산량) / (기존 연산량)\\n\"}]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"5\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"여러 패스를 조합한 파이프라인\\n단순 체이닝\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"--pass-pipeline=\\\"builtin.module(pass1,pass2,pass3)\\\"\\n\"}]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"순서대로 실행된다.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ol\",null,{\"start\":\"6\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"중첩된 패스 앵커링\\n이 개념이 진짜 중요함.\\n필요한 이유는\"}],\"\\n\"]}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스는 특정 IR 레벨에서만 동작하고\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"올바른 nesting을 안 쓰면 패스가 아예 실행되지 않기 때문\\n예시 구조는 아래와 같음\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"module {\\n  module {\\n    func.func ...\\n  }\\n  gpu.module {\\n    gpu.func ...\\n  }\\n}\\n\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"func.func 에만 CSE + canonicalize 적용\"}],\"\\n\",[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"mlir-opt --pass-pipeline='\\n  builtin.module(\\n    builtin.module(\\n      func.func(cse,canonicalize),\\n      convert-to-llvm\\n    )\\n  )'\\n\"}]}],\"\\n\",\"$Le\",\"\\n\",\"$Lf\",\"\\n\",\"$L10\",\"\\n\",\"$L11\",\"\\n\",\"$L12\",\"\\n\",\"$L13\",\"\\n\",\"$L14\",\"\\n\",\"$L15\",\"\\n\",\"$L16\",\"\\n\",\"$L17\",\"\\n\",\"$L18\",\"\\n\",\"$L19\",\"\\n\",\"$L1a\",\"\\n\",\"$L1b\",\"\\n\",\"$L1c\",\"\\n\",\"$L1d\"]}],\"$L1e\",\"$L1f\"]}]\n"])</script><script>self.__next_f.push([1,"20:I[80852,[\"/blog/_next/static/chunks/796e69ae18b2784c.js\",\"/blog/_next/static/chunks/631eeae4923b8465.js\"],\"default\"]\ne:[\"$\",\"p\",null,{\"children\":\"결과\"}]\nf:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"func.func 만 최적화 됨\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"gpu.module은 그대로 유지가 됨\"}],\"\\n\"]}]\n10:[\"$\",\"p\",null,{\"children\":\"이러한 중첩 앵커링은 성능적으로 장점이 있음.\"}]\n11:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스가 IR 서브셋 단위로 병렬 실행이 가능함.\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"캐시 지역성 개선\"}],\"\\n\"]}]\n12:[\"$\",\"pre\",null,{\"children\":[\"$\",\"code\",null,{\"children\":\"builtin.module(func.func(...))\\n\\n가\\n\\nbuiltin.module(...)\\n보다 효율적임.\\n\"}]}]\n13:[\"$\",\"ol\",null,{\"start\":\"7\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"자주 쓰는 CLI 플래그들\\n디버깅 에서는\"}],\"\\n\"]}]\n14:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"--debug\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"--debug-only=\\\"tag\\\"\",\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"\\\"greedy-rewriter\\\" 나 \\\"dialect-conversion\\\"\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}]\n15:[\"$\",\"p\",null,{\"children\":\"IR 출력\"}]\n16:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"--mlir-print-ir-after-all\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"--mlir-print-ir-after-change\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"--mlir-print-ir-after-failure\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[[\"$\",\"code\",null,{\"children\":\"--mlir-print-ir-tree-dir=\u003cdir\u003e\"}],\" (IR을 파일 트리로 저장함. 대규모 IR 디버깅 하려면 사실상 필수)\"]}],\"\\n\"]}]\n17:[\"$\",\"p\",null,{\"children\":\"통계 / 성능 관련해서는\"}]\n18:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"--mlir-pass-statistics\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"--mlir-timing\"}],\"\\n\"]}]\n19:[\"$\",\"p\",null,{\"children\":\"기타\"}]\n1a:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"--emit-bytecode : MLIR bytecode를 출력함.\\\\\"}],\"\\n\"]}]\n1b:[\"$\",\"p\",null,{\"children\":\"=====================================================================\"}]\n1c:[\"$\",\"p\",null,{\"children\":\"요약해 보자면\"}]\n1d:[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":\"mlir-opt는 MLIR 패스 실행의 표준 테스트 도구\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스 실행은 --pass-pipeline 사용이 정석임\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"패스 앵커링 (op-level) 개념을 이해해야 제대로 동작함\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":[\"패스 옵션은 \",[\"$\",\"code\",null,{\"children\":\"{key=value}\"}],\" 문법\"]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"중첩 파이프라인은 정확성 + 성능 모두에 중요함\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"디버깅시 --debug-only, --mlir-print-ir-*는 필수 도구임.\"}],\"\\n\"]}]\n1e:[\"$\",\"hr\",null,{\"style\":{\"border\":0,\"borderTop\":\"1px solid #eee\",\"margin\":\"36px 0\"}}]\n1f:[\"$\",\"$L20\",null,{}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"21:I[27201,[\"/blog/_next/static/chunks/ff1a16fafef87110.js\",\"/blog/_next/static/chunks/247eb132b7f7b574.js\"],\"IconMark\"]\nc:[[\"$\",\"title\",\"0\",{\"children\":\"MLIR Tutorial mlir-opt 에 대하여 - CPIST's blog\"}],[\"$\",\"meta\",\"1\",{\"name\":\"description\",\"content\":\"Using mlir-opt\"}],[\"$\",\"link\",\"2\",{\"rel\":\"icon\",\"href\":\"/blog/favicon.ico?favicon.0b3bf435.ico\",\"sizes\":\"256x256\",\"type\":\"image/x-icon\"}],[\"$\",\"$L21\",\"3\",{}]]\n8:null\n"])</script></body></html>